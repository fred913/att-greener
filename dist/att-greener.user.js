// ==UserScript==
// @name         ATT Greener
// @namespace    https://ft2.club/
// @version      0.1.2
// @description  Provide a better experience for AMLL TTML Tool users.
// @author       Sheng Fan
// @match        https://amll-ttml-tool.stevexmh.net/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=amll-ttml-tool.stevexmh.net
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==
!function(){"use strict";const t='div[role="menu"][data-state="open"]';function e(t){if(1!==t.length){for(const n of t)if(e(n))return!0;return!1}const n=t.codePointAt(0);return n>=19968&&n<=40959||n>=13312&&n<=19903||n>=131072&&n<=173791||n>=173824&&n<=177983||n>=177984&&n<=178207||n>=178208&&n<=183983||n>=183984&&n<=191471||n>=194560&&n<=195103||n>=12352&&n<=12447||n>=12448&&n<=12543||n>=44032&&n<=55215}var n,i,s;function o(t){const e={};for(const n of t)e[n.key]=n.value;return e}!function(t){class n{static max(...t){return new n(Math.max(...t.filter((t=>null!==t)).map((t=>t.milliSeconds))))}static min(...t){return new n(Math.min(...t.filter((t=>null!==t)).map((t=>t.milliSeconds))))}constructor(t){this.milliSeconds=0,this.milliSeconds=t}seconds(){return this.milliSeconds/1e3}formatted(){const t=Math.floor(this.seconds()),e=t%60;return`${Math.floor(t/60)}:${e<10?"0":""}${e}`}}var i,s;t.Timestamp=n,(i=t.VoiceAgentType||(t.VoiceAgentType={})).Vocal="vocal",i.BackgroundVocal="background-vocal",i.Other="other",(s=t.LineAnnotationRole||(t.LineAnnotationRole={})).Prononciation="pron",s.Translation="trans";class o{constructor(t){this.syllables=t.syllables,this.voiceAgent=t.voiceAgent,this.annotations=t.annotations}toLineSyncedLine(){const t=this.syllables.map((t=>t.text)).join(""),e=n.min(...this.syllables.filter((t=>0!=t.start?.milliSeconds||0!=t.end?.milliSeconds||""!=t.text.trim())).map((t=>t.start))),i=n.max(...this.syllables.filter((t=>0!=t.start?.milliSeconds||0!=t.end?.milliSeconds||""!=t.text.trim())).map((t=>t.end)));return new l({text:t,start:e,end:i,voiceAgent:this.voiceAgent,annotations:this.annotations})}extractAnnotations(t){return this.toLineSyncedLine().extractAnnotations(t)}}t.SyllableSyncedLine=o;class l{static checkOverlap(t,e){if(null===t.start||null===t.end||null===e.start||null===e.end)return!1;return t.start.milliSeconds<e.end.milliSeconds&&e.start.milliSeconds<t.end.milliSeconds}static fromText(t){return new l({text:t})}constructor(t){this.text=t.text,this.start=t.start||null,this.end=t.end||null,this.voiceAgent=t.voiceAgent||null,this.annotations=t.annotations||[]}extractAnnotations(t){return this.annotations.filter((e=>e.role===t)).map((t=>{const e=t.line;return e.start=this.start,e.end=this.end,e}))}}t.LineSyncedLine=l,function(t){function i(t){const i=[];let s="",o=t.text;for(;o.length>0;){const n=o[0];e(n)&&s.length>0&&"("!=s&&"（"!=s&&(i.push({text:s,start:null,end:null,annotations:t.annotations}),s=""),s+=n,o=o.slice(1)}s.length>0&&(")"==s||"）"==s?i[i.length-1].text+=s:i.push({text:s,start:null,end:null,annotations:t.annotations}));const l=t.end?.milliSeconds-t.start?.milliSeconds;let r=0;for(const e in i){const s=l/t.text.replace(/[\(\)（）]/g,"").length*i[e].text.replace(/[\(\)（）]/g,"").length,o=i[e];o.start=new n(Math.round(t.start?.milliSeconds+r)),o.end=new n(Math.round(t.start?.milliSeconds+r+s)),r+=s}return i}t.extractLineAnnotations=function(t,e){return t.flatMap((t=>t instanceof o||t instanceof l?t.extractAnnotations(e):[]))},t.splitWordSyllables=i,t.preprocessLinesForLyricify=function(t){return t.map((t=>{if(t instanceof o){const e=t.syllables.flatMap(i);return new o({syllables:e,voiceAgent:t.voiceAgent,annotations:t.annotations})}return t}))}}(t.Utils||(t.Utils={}))}(n||(n={})),function(t){var e,i,s,o;e=t.Abstraction||(t.Abstraction={}),i=e.ALRC||(e.ALRC={}),(s=i.ALRCStylePosition||(i.ALRCStylePosition={}))[s.Undefined=0]="Undefined",s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right",(o=i.ALRCStyleAccent||(i.ALRCStyleAccent={}))[o.Normal=0]="Normal",o[o.Background=1]="Background",o[o.Whisper=2]="Whisper",o[o.Emphasise=3]="Emphasise",function(e){function i(t){let e="",i=null;const s=[],o=[];let l=0;for(const e of t){const t=(e.voiceAgent?.type==n.VoiceAgentType.BackgroundVocal?6:3)+(2!=e.voiceAgent?.n?1:2);o.push(t);const r=[];if(e instanceof n.SyllableSyncedLine)for(const t of e.syllables)i=n.Timestamp.min(i,t.start),r.push({text:t.text,start:t.start?.milliSeconds||0,end:t.end?.milliSeconds||0});else e instanceof n.LineSyncedLine&&(i=e.start,r.push({text:e.text,start:e.start?.milliSeconds||0,end:e.end?.milliSeconds||0}));if(s.push(r),l>0&&null!=i){const t=s[l-1];t instanceof n.LineSyncedLine&&(t.end=i)}l+=1}l=0;for(const t of s){e+=`[${o[l]}]`;for(const n of t)e+=`${n.text}(${Math.round(n.start)},${Math.round(n.end-n.start)})`;e+="\n",l+=1}return e.trim()}function s(t){let e="";for(const i of t){let t;t=i instanceof n.SyllableSyncedLine?i.toLineSyncedLine():i;const s=t.start;if(s){const n=Math.floor(s.milliSeconds/6e4),i=Math.floor(s.milliSeconds%6e4/1e3),o=s.milliSeconds%1e3;e+=`[${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}.${o.toString().padStart(3,"0")}]${t.text}\n`}}return e.trim()}function o(t){let e="";for(const i of t){let t;t=i instanceof n.SyllableSyncedLine?i.toLineSyncedLine():i;const s=t.start,o=t.end;s&&(e+=`[${Math.round(s.milliSeconds)},${Math.round(o?.milliSeconds||0)}]${t.text}\n`)}return e.trim()}function l(t){let e="";for(const i of t){let t;t=i instanceof n.SyllableSyncedLine?i.toLineSyncedLine():i;const s=t.start,o=t.end,l=o?.milliSeconds||null,r=l&&s?l-s.milliSeconds:null;if(i instanceof n.SyllableSyncedLine){if(s){e+=`[${Math.round(s.milliSeconds)},${Math.round(r||0)}]`;for(const t of i.syllables){const n=t.end&&t.start?t.end.milliSeconds-t.start.milliSeconds:null;e+=`${t.text}(${Math.round(t.start?.milliSeconds||0)},${Math.round(n||0)})`}e+="\n"}}else i instanceof n.LineSyncedLine&&s&&(e+=`[${Math.round(s.milliSeconds)},${Math.round(r||0)}]${t.text}(${Math.round(s.milliSeconds)},${Math.round(r||0)})\n`)}return e.trim()}function r(t){let e="";for(const i of t){let t;t=i instanceof n.SyllableSyncedLine?i.toLineSyncedLine():i;const s=t.start,o=t.end,l=o?.milliSeconds||null,r=l&&s?l-s.milliSeconds:null;if(i instanceof n.SyllableSyncedLine){if(s){e+=`[${Math.round(s.milliSeconds)},${Math.round(r||0)}]`;for(const t of i.syllables){const n=t.end&&t.start?t.end.milliSeconds-t.start.milliSeconds:null;e+=`(${Math.round(t.start?.milliSeconds||0)},${Math.round(n||0)},0)${t.text}`}e+="\n"}}else i instanceof n.LineSyncedLine&&s&&(e+=`[${Math.round(s.milliSeconds)},${Math.round(r||0)}](${Math.round(s.milliSeconds)},${Math.round(r||0)},0)${t.text}\n`)}return e.trim()}function a(t){const e={li:{},si:null,h:{s:[]},l:[]};for(const i of t)if(i instanceof n.SyllableSyncedLine){const t={w:i.syllables.map((t=>({f:t.start?.milliSeconds||0,t:t.end?.milliSeconds||0,w:t.text}))),f:n.Timestamp.min(...i.syllables.map((t=>t.start))).milliSeconds,t:n.Timestamp.max(...i.syllables.map((t=>t.end))).milliSeconds};e.l.push(t)}else if(i instanceof n.LineSyncedLine){const t={tx:i.text,f:i.start?.milliSeconds||0,t:i.end?.milliSeconds||0};e.l.push(t)}return JSON.stringify(e)}function c(t){let e="",i=1;for(const s of t){let t;t=s instanceof n.SyllableSyncedLine?s.toLineSyncedLine():s;const o=t.start,l=t.end;if(o&&l){const s=new Date(o.milliSeconds),r=new Date(l.milliSeconds),a=`${s.getUTCHours().toString().padStart(2,"0")}:${s.getUTCMinutes().toString().padStart(2,"0")}:${s.getUTCSeconds().toString().padStart(2,"0")},${(o.milliSeconds%1e3).toString().padStart(3,"0")}`,c=`${r.getUTCHours().toString().padStart(2,"0")}:${r.getUTCMinutes().toString().padStart(2,"0")}:${r.getUTCSeconds().toString().padStart(2,"0")},${(l.milliSeconds%1e3).toString().padStart(3,"0")}`;let d=t.text.trim();t.voiceAgent&&t.voiceAgent.type==n.VoiceAgentType.BackgroundVocal&&(d=`(${d})`),e+=`${i}\n${a} --\x3e ${c}\n${d}\n\n`,i++}}return e.trim()}function d(e){let o="";const l=n.Utils.extractLineAnnotations(e,n.LineAnnotationRole.Translation),r=n.Utils.extractLineAnnotations(e,n.LineAnnotationRole.Prononciation);return o+=`[lyrics: ${t.Dumping.LQE.createLQEPartHeader({format:"Lyricify Syllable",language:"en-US"})}]\n`,o+=i(e).trimEnd(),o+="\n\n",l.length>0&&(o+=`\n[translation: ${t.Dumping.LQE.createLQEPartHeader({format:"LRC",language:"zh-CN"})}]\n`,o+=s(l).trimEnd(),o+="\n\n"),r.length>0&&(o+=`\n[pronunciation: ${t.Dumping.LQE.createLQEPartHeader({format:"LRC",language:"romaji"})}]\n`,o+=s(r).trimEnd(),o+="\n\n"),o.trim()}function u(t){function e(t){const e=Math.floor(t/6e4),n=Math.floor(t%6e4/1e3),i=t%1e3;return`[${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}.${i.toString().padStart(3,"0")}]`}let i="";for(const s of t){let t;t=s instanceof n.SyllableSyncedLine?s.toLineSyncedLine():s;const o=t.start,l=t.end;if(s instanceof n.SyllableSyncedLine){if(o&&l){let t=null;for(const n of s.syllables)n.start?.milliSeconds!=t&&(i+=e(n.start?.milliSeconds||0)),i+=n.text,i+=e(n.end?.milliSeconds||0),t=n.end?.milliSeconds||0;i+="\n"}}else s instanceof n.LineSyncedLine&&o&&l&&(i+=e(o.milliSeconds||0),i+=t.text,i+=e(l?.milliSeconds||0),i+="\n");for(const t of s.annotations)if(t.role==n.LineAnnotationRole.Translation){i+=t.line.text,i+="\n";break}}return i.trim()}function m(t){switch(t){case"lys":return i;case"lyl":return o;case"lrc":return s;case"qrc":return l;case"alrc":return a;case"srt":return c;case"yrc":return r;case"spl":return u;case"lqe":return d;case"ttml":case"ttml_amll":case"apple_syllable":case"krc":return null;default:return console.error(`Unsupported format: ${t}`),null}}(e.YRC||(e.YRC={})).createHeaderLines=function(t){const e=[],n=[];for(let e=0;e<t.lyricists.length;e++){const i=t.lyricists[e];e>0&&n.push({tx:"/"}),n.push({tx:i})}const i=[];for(let e=0;e<t.musicians.length;e++){const n=t.musicians[e];e>0&&i.push({tx:"/"}),i.push({tx:n})}return n.length>0&&e.push({t:0,c:[{tx:"作词: "},...n]}),i.length>0&&e.push({t:0,c:[{tx:"作曲: "},...i]}),e},(e.LQE||(e.LQE={})).createLQEPartHeader=function(t){return Object.entries(t).map((([t,e])=>`${t}@${e}`)).join(", ")},e.dumpLYS=i,e.dumpLRC=s,e.dumpLYL=o,e.dumpQRC=l,e.dumpYRC=r,e.dumpALRC=a,e.dumpSRT=c,e.dumpLQE=d,e.dumpSPL=u,e.dump=function(t,e){const i=m(t);if(!i)return"[ERROR] Unsupported";let s;switch(t){case"lys":case"lqe":case"yrc":case"qrc":case"krc":s=n.Utils.preprocessLinesForLyricify(e);break;case"lyl":case"lrc":case"alrc":case"ttml":case"ttml_amll":case"apple_syllable":case"srt":case"spl":s=e;break;default:throw new Error("should not happen")}return i(s)},e.supportDump=function(t){return null!=m(t)}}(t.Dumping||(t.Dumping={}))}(i||(i={})),function(t){t.TYPES={lys:{displayName:"Lyricify Syllable",extensions:[".lys"]},lyl:{displayName:"Lyricify Lines",extensions:[".lyl"]},lqe:{displayName:"Lyricify Quick Export",extensions:[".lqe"]},lrc:{displayName:"LRC",extensions:[".lrc"]},alrc:{displayName:"ALRC",extensions:[".alrc"]},ttml:{displayName:"TTML (Original)",extensions:[".ttml"]},ttml_amll:{displayName:"TTML (AMLL Standards)",extensions:[".ttml"]},apple_syllable:{displayName:"Apple Syllable",extensions:[".json",".as",".asyl"]},yrc:{displayName:"YRC",extensions:[".yrc"]},qrc:{displayName:"QRC (Lyricify Standards)",extensions:[".qrc"]},krc:{displayName:"KRC",extensions:[".krc"]},srt:{displayName:"SRT",extensions:[".srt"]},spl:{displayName:"Salt Player Lyrics",extensions:[".lrc"]}},t.allTypes=Object.keys(t.TYPES),t.getLyricFormatDisplayName=function(e){return t.TYPES[e].displayName},t.getLyricFormatFileExtensions=function(e){return t.TYPES[e].extensions},t.requestReadLyricsFile=async function(t,e){const n=e.map((t=>`${t}`)),i=await unsafeWindow.showOpenFilePicker({types:[{description:t,accept:{"text/lyricsSpecific":[...n]}}]});if(i.length>0){const t=i[0],e=await t.getFile();return await e.text()}return null},t.requestWriteLyricsFile=async function(t,e,n,i){const s=e.map((t=>`${t}`)),o=await unsafeWindow.showSaveFilePicker({types:[{description:t,accept:{"text/lyricsSpecific":[...s]}}],suggestedName:i?.fileName||"lyrics"});if(o){const t=await o.createWritable();return await t.write(n),await t.close(),!0}return!1}}(s||(s={}));let l=null;const r=console.log,a=(...t)=>{if(2===t.length&&"string"==typeof t[0]){const[e,n]=t;"lyricLines atom changed"===e&&(r("got new lyricLines",n),l=n)}r(...t)};function c(){return l}function d(){const t=c();if(t){const e=t.lyricLines.map((t=>{const e=t.words.map((t=>({start:new n.Timestamp(t.startTime),end:new n.Timestamp(t.endTime),text:t.word,annotations:[]}))),i={n:t.isDuet?2:1,type:t.isBG?n.VoiceAgentType.BackgroundVocal:n.VoiceAgentType.Vocal},s=[];return t.translatedLyric&&s.push({role:n.LineAnnotationRole.Translation,line:new n.LineSyncedLine({text:t.translatedLyric})}),t.romanLyric&&s.push({role:n.LineAnnotationRole.Prononciation,line:new n.LineSyncedLine({text:t.romanLyric})}),new n.SyllableSyncedLine({syllables:e,voiceAgent:i,annotations:s})}));return console.log("currentLyricsToCoreLyric",e),e}return null}function u(t){return function(){if(unsafeWindow.Toastify)return unsafeWindow.Toastify;throw new Error("Toastify hasn't loaded yet")}()(t)}function m(t){if(t instanceof n.SyllableSyncedLine){let e=1;for(;e<t.syllables.length;){" "==t.syllables[e].text&&(t.syllables.splice(e,1),t.syllables[e-1].text+=" "),e++}}if(t.voiceAgent?.type===n.VoiceAgentType.BackgroundVocal)if(t instanceof n.SyllableSyncedLine){for(;t.syllables[0].text.startsWith("(")||t.syllables[0].text.startsWith("（");)t.syllables[0].text=t.syllables[0].text.slice(1);for(;t.syllables[t.syllables.length-1].text.endsWith(")")||t.syllables[t.syllables.length-1].text.endsWith("）");)t.syllables[t.syllables.length-1].text=t.syllables[t.syllables.length-1].text.slice(0,-1);t.syllables[0].text=`(${t.syllables[0].text}`,t.syllables[t.syllables.length-1].text=`${t.syllables[t.syllables.length-1].text})`}else if(t instanceof n.LineSyncedLine){for(;t.text.startsWith("(")||t.text.startsWith("（");)t.text=t.text.slice(1);for(;t.text.endsWith(")")||t.text.endsWith("）");)t.text=t.text.slice(0,-1);t.text=`(${t.text})`}return t}const f=[{check(t){for(const e of t.itemsContainer.children)if("导出到 lyric"===e.innerText.toLowerCase().trim())return!0;return!1},inject(t){console.log(t),console.log("Detected exportAs menu, doing injection");for(let e=0;e<t.itemsContainer.children.length;){const n=t.itemsContainer.children[e];"导出到 ASS 字幕"===n.innerText.trim()?t.itemsContainer.removeChild(n):(n.innerText="导出到 ASS (.ass) (旧版选项)",e++)}const e=c(),l=d();function r(t,n){if(document.dispatchEvent(new PointerEvent("pointerdown")),!l)return void u({text:"当前无歌词数据，无法导出",duration:2600,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"rgb(18, 18, 18)",borderRadius:"16px",boxShadow:"unset"}}).showToast();let r,a="";switch(n){case"lyl":a+="[type:LyricifyLines]\n";case"lqe":"lqe"==n&&(a+="[Lyricify Quick Export]\n",a+="[version:1.0]\n");case"lys":case"qrc":case"lrc":const t=function(t){const e=o(t);let n="";if(e.musicName)for(const t of e.musicName)n+=`[ti:${t}]\n`;if(e.isrc)for(const t of e.isrc)n+=`[isrc:${t}]\n`;if(e.album)for(const t of e.album)n+=`[al:${t}]\n`;if(e.artists)for(const t of e.artists)n+=`[ar:${t}]\n`;if(e.ncmMusicId)for(const t of e.ncmMusicId)n+=`[ncm-id:${t}]\n`;if(e.qqMusicId)for(const t of e.qqMusicId)n+=`[qqmusic-id:${t}]\n`;if(e.spotifyId)for(const t of e.spotifyId)n+=`[spotify-id:${t}]\n`;if(e.appleMusicId)for(const t of e.appleMusicId)n+=`[applemusic-id:${t}]\n`;if(e.ttmlAuthorGithubLogin&&e.ttmlAuthorGithub){const t=e.ttmlAuthorGithubLogin[0];n+=`[by:${t}]\n`,n+=`[by-github-login:${t}]\n`,n+=`[by-github-id:${e.ttmlAuthorGithub[0]}]\n`}return n}(e?.metadata||[]).trim();a+=t,t&&(a+="\n"),"lqe"==n&&(a+="\n");break;case"yrc":a+=function(t){const e=o(t),n={lyricists:e.lyricists||[],musicians:e.musicians||e.artists||[]};return i.Dumping.YRC.createHeaderLines(n)}(e?.metadata||[]).map((t=>JSON.stringify(t))).join("\n"),a+="\n"}switch(n){case"lys":case"qrc":case"lqe":r=l.map(m);break;default:r=l}const c=a+i.Dumping.dump(n,r)+"",d=s.getLyricFormatFileExtensions(n),f=s.getLyricFormatDisplayName(n);"clipboard"===t?navigator.clipboard.writeText(c).then((()=>{u({text:`歌词内容已复制为 ${f} 格式`,duration:2600,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"rgb(18, 18, 18)",borderRadius:"16px",boxShadow:"unset"}}).showToast()})).catch((()=>{u({text:"复制失败",duration:2e3,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"rgb(18, 18, 18)",borderRadius:"16px",boxShadow:"unset"}}).showToast()})):s.requestWriteLyricsFile(s.getLyricFormatDisplayName(n),d,c,{fileName:"lyrics"}).then((t=>{u({text:t?`歌词已导出为 ${f} 格式`:"导出失败：已取消",duration:t?2600:1800,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"rgb(18, 18, 18)",borderRadius:"16px",boxShadow:"unset"}}).showToast()}))}function a(t,e,n){const o=s.getLyricFormatDisplayName(t),l=s.getLyricFormatFileExtensions(t),a=document.createElement("div");var c;return a.classList.add("rt-reset","rt-BaseMenuItem","rt-DropdownMenuItem"),a.tabIndex=-1,a.setAttribute("role","menuitem"),a.setAttribute("data-orientation","vertical"),a.setAttribute("data-radix-collection-item",""),a.innerText=n||`导出到 ${o} (${l.join(", ")})`,i.Dumping.supportDump(t)||(a.innerText+=" (尚未实现)"),(c=a).addEventListener("mouseover",(()=>{c.setAttribute("data-highlighted","true")})),c.addEventListener("mouseout",(()=>{c.removeAttribute("data-highlighted")})),c.addEventListener("blur",(()=>{c.removeAttribute("data-highlighted")})),a.addEventListener("click",(e=>{e instanceof MouseEvent&&0!==e.button||r("download",t)})),a.addEventListener("contextmenu",(e=>(e.preventDefault(),e.stopPropagation(),r("clipboard",t),!1))),a}for(const e of s.allTypes){if(!i.Dumping.supportDump(e))continue;const n=a(e);t.itemsContainer.appendChild(n)}if(l){const e=n.Utils.extractLineAnnotations(l,n.LineAnnotationRole.Translation);if(e.length>0){const e=a("lrc",0,"导出翻译为 LRC (.lrc)");t.itemsContainer.appendChild(e)}const i=n.Utils.extractLineAnnotations(l,n.LineAnnotationRole.Prononciation);if(i.length>0){const e=a("lrc",0,"导出音译为 LRC (.lrc)");t.itemsContainer.appendChild(e)}}}}];function y(t){if(t.dataset._injected)return;t.dataset._injected="true";const e=t.querySelector("div.rt-ScrollAreaViewport > div > div");if(!e)return void console.warn("Failed to find menu item container");const n={itemsContainer:e,menu:t};for(const t of f)t.check(n)&&t.inject(n)}unsafeWindow.console.log=a,new MutationObserver((e=>{for(const n of e)for(const e of Array.from(n.addedNodes))if(e instanceof HTMLElement&&(e.matches(t)&&y(e),1==e.childNodes.length)){const n=e.firstChild;if(!(n instanceof HTMLElement))continue;n.matches(t)&&(console.log("Found Radix menu in the first child"),y(n))}})).observe(document.body,{childList:!0,subtree:!0}),localStorage.setItem("noticeLevelDialog","9"),async function(){document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">');const t=unsafeWindow.document.createElement("script");return t.src="https://cdn.jsdelivr.net/npm/toastify-js",new Promise((e=>{t.onload=()=>{e(!0)},unsafeWindow.document.body.appendChild(t)}))}().then((()=>{u({text:"ATT Greener 加载成功\n当前功能：导出指定格式歌词\n测试版本，遇到问题欢迎在交流群反馈",duration:3e3,close:!0,gravity:"top",position:"right",stopOnFocus:!0,onClick:function(){},style:{background:"rgb(18, 18, 18)",borderRadius:"16px"}}).showToast()}))}();
